{% load static from staticfiles %}
<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <title>COMPSOC - {% block title %}University of Edinburgh Computer Science Society{% endblock %}</title>
        
        <meta charset="utf=8">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
        <link rel="stylesheet" href="{% static "compsoc/css/bootstrap.min.css" %}">
        <link rel="stylesheet" href="{% static "compsoc/css/override.css" %}">
        
        <link rel="icon" type="image/ico" href="{% static "compsoc/img/favicon.ico" %}">
        <link rel="apple-touch-icon" type="image/png" hrep="{% static "compsoc/img/compsoc-icon.png" %}">
    
        <!-- HTML 5 Shiv for Pre IE9: -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respons.min.js"></script>
        <![endif] -->
    </head>

    <body>
        <!--
        <aside class="announce">
            <div class="container">
                <div class="alert alert-info alert-dismissable">
                    {% block announcement %}
                    {% endblock %}
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                </div>
            </div>
        </aside>
        -->

        <header class="header">
            <div class="container">
                <a href="/compsoc/page/home">
                  <img class="header-img" src="{% static "compsoc/img/compsoc.png" %}" alt="CompSoc Edinburgh" >
                </a>
                
            </div>
        </header>
        
        <nav class="navbar navbar-compsoc">
            <div class="container">
                <div class="navbar-header">
                    <!-- Toggle Navigation button for XS and SM -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                
                <!-- <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                    
                    
                    </ul>
                </div> -->
                
            </div>
        </nav>
        
        
        <div class="content">
            <div class="container">
            
                <!--[if lte IE 8]><div id="i-hate-ie">
                    <h3>WE LOVE HTML5, CSS3 AND KITTENS!</h3>
                    <p>Your browser, unfortunately, doesn't and we can't be bothered to write special CSS and stuff just so it works in browsers written by numpties...</p>
                    <p>Basically please use anything <em>but</em> IE!</p>
                </div><![endif]-->
                
                <!-- Main content and Sidebar: -->
                <div class="main row" role="main">
                    <div class="col-sm-8">
                        
                        <!-- MAIN PAGE CONTENT:  --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   -->
                        
                        {% block content %}{% endblock %}
                    </div>
            
            
                    <!--  SIDEBAR  --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   --   -->
            
                    <aside class="col-sm-4 sidebar">
                        
                        <h1>Events</h1>
                        <!-- using the hasacalendar.com api -->
                        <div id="events">
                        </div>
                        <!-- end hasacalendar -->
                        {% block sidebar%}
                        {% endblock %}
                        
                    </aside>
                </div>
        
            </div>
        </div>
        
        <div class="container">
            <footer>
                New New CompSoc Website FTW!
                <span style="float: right;">Proudly not powered by WordPress</span>
            </footer>
        </div>
        
        
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://code.jquery.com/jquery.js"></script>
        <script>
            function PopulateEvents(data) {                                                              
                console.log(data.data);                                                        
                var cal = data.data;                                                           
                var len = 3;
                var leng = len;
                if(cal.length <= len) leng = cal.length;
                for(i = 0; i < leng; i++) {                                              
                    //TODO get the time so I can pull it apart
                    var desc = cal[i].description;
                    if(desc.length > 50) desc = desc.substring(0,50)+"...";
                    var ev = "";
                    ev = "<section class='event'><div class='event-cal'><div class='event-date'><span class='event-date-day'>";
                    ev += cal[i].start.displaylocal;
                    ev += "</span>";
                    ev += "</div>";
                    ev += "<div class='event-time'></div>";
                    ev += "</div>";
                    ev += "<div class='event-description'>";
                    ev += "<a href='"+cal[i].url+"'><h2>"+cal[i].summary+"</h2></a>";
                    ev += "<p>"+desc+"</p>";
                    ev += "</div>";
                    ev += "<div style='clear: both;'></div>";

                    ev += "</section>";
                    $("#events").append(ev);                      
                    //console.log(cal[i].summary);                                               
                }                                                                              
                //console.log(data.data.length);                                                 
            }                                                                                  
        </script>
        <script src="http://compsoc.api1.hasacalendar.co.uk/event/jsonp?callback=PopulateEvents"></script>
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="{% static "compsoc/js/bootstrap.min.js" %}"></script>
  </body>


</html>
